Кирилл, привет!

Спасибо за комментарии и полезные замечания!
В прошлый раз что-то не заметил ) Обычно коментарии цветные.

>Здесь объявлен PostgresOperator, но в коде он не используется. Для проверки таких вещей, а также форматирования кода обычно используется библиотека Flake8. Подробнее об ее использовании можно почитать тут - https://flake8.pycqa.org/en/latest/

VSC тоже это подсвечивает. Буду обращать внимание.

>Параметры подключения к  API не следует хардкодить, особенно ключи подключения
Следует сделать connection в веб-интерфейсе Airflow. К тому же это удобнее по той причине, что если поменяются параметры ты меняешь их один раз в Airflow, а не в каждом из дагов

У меня были проблемы с запуском контейнера для проекта, поэтому приходилось каждый раз заново создавать connection и variables.
Сейчас сделал настройки подключения к API через variables.

>Крупные sql запросы лучше выносить в отдельные файлы в предназначенный для них каталог, а потом уже вызывать, так гораздо легче и удобнее читать код дага

Вынес, но не уверен, что это оптимальный способ.
